---
- name: Install Core
  hosts: localhost
  become: true
  vars:
    xbps_packages:
      - Signal-Desktop
      - alsa-plugins-pulseaudio
      - apulse
      - bspwm
      - binutils
      - curl
      - github-cli
      - firefox
      - kde5
      - mpv
      - openntpd
      - nvidia
      - void-repo-nonfree
      - void-repo-multilib
      - void-repo-multilib-nonfree
      - lutris
      - vulkan-loader-32bit
      - wine-32bit
      - wine-mono
      - pamixer
      - pavucontrol
      - pulseaudio
      - tar
      - xbps
      - xorg
      - xz
      - wget
    xdebs:
      - { link: "https://downloads.vivaldi.com/stable/vivaldi-stable_5.1.2567.66-1_amd64.deb", name: "vivaldi-stable-5.1.2567.66_1"}

  tasks:
    - name: Install xbps packages
      community.general.xbps:
        name: "{{item}}"
        state: latest
      loop: "{{xbps_packages | flatten(1)}}"
    - name: remove
      community.general.xbps:
        name: "{{item}}"
        state: absent
      loop:
        - mono
        - steam
    - name: Install xdebs
      ansible.builtin.shell:
        cmd: wget "{{item.link}}" -O "/tmp/{{item.name}}.deb" && /home/void/ansible/submodules/xdeb/xdeb -Sde "/tmp/{{item.name}}.deb" && xbps-install -yR /home/void/.config/xdeb/binpkgs "{{item.name}}"
      loop: "{{xdebs}}"
      args:
        executable: /home/linuxbrew/.linuxbrew/bin/fish
        chdir: /home/void/.config/xdeb

